{
  "version": 3,
  "sources": ["../../../src/libs/html-rendering/html-rendering.ts"],
  "sourcesContent": ["import type { ApiReferenceConfigurationWithSource, HtmlRenderingConfiguration } from '@scalar/types/api-reference'\n\n// Re-export the type for convenience\nexport type { HtmlRenderingConfiguration }\n\n/**\n * Helper function to add consistent indentation to multiline strings\n * @param str The string to indent\n * @param spaces Number of spaces for each level\n * @param initialIndent Whether to indent the first line\n */\nconst addIndent = (str: string, spaces: number = 2, initialIndent: boolean = false): string => {\n  const indent = ' '.repeat(spaces)\n  const lines = str.split('\\n')\n  return lines\n    .map((line, index) => {\n      if (index === 0 && !initialIndent) {\n        return line\n      }\n      return `${indent}${line}`\n    })\n    .join('\\n')\n}\n\n/**\n * Generate the style tag with custom theme if needed\n */\nconst getStyles = (configuration: Partial<HtmlRenderingConfiguration>, customTheme: string): string => {\n  const styles: string[] = []\n\n  if (configuration.customCss) {\n    styles.push('/* Custom CSS */')\n    styles.push(configuration.customCss)\n  }\n\n  if (!configuration.theme && customTheme) {\n    styles.push('/* Custom Theme */')\n    styles.push(customTheme)\n  }\n\n  if (styles.length === 0) {\n    return ''\n  }\n\n  return `\n    <style type=\"text/css\">\n      ${addIndent(styles.join('\\n\\n'), 6)}\n    </style>`\n}\n\n/**\n * The HTML document to render the Scalar API reference.\n *\n * We must check the passed in configuration and not the configuration for the theme as the configuration will have it\n * defaulted to 'default'\n */\nexport const getHtmlDocument = (givenConfiguration: Partial<HtmlRenderingConfiguration>, customTheme = '') => {\n  const { cdn, pageTitle, customCss, theme, ...rest } = givenConfiguration\n\n  const configuration = getConfiguration({\n    ...rest,\n    ...(theme ? { theme } : {}),\n    customCss,\n  })\n\n  const content = `<!doctype html>\n<html>\n  <head>\n    <title>${pageTitle ?? 'Scalar API Reference'}</title>\n    <meta charset=\"utf-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1\" />${getStyles(configuration, customTheme)}\n  </head>\n  <body>\n    <div id=\"app\"></div>${getScriptTags(configuration, cdn)}\n  </body>\n</html>`\n\n  return content\n}\n\n/**\n * Helper function to serialize arrays that may contain functions\n */\nconst serializeArrayWithFunctions = (arr: unknown[]): string => {\n  return `[${arr.map((item) => (typeof item === 'function' ? item.toString() : JSON.stringify(item))).join(', ')}]`\n}\n\n/**\n * The script tags to load the @scalar/api-reference package from the CDN.\n */\nexport function getScriptTags(configuration: Partial<ApiReferenceConfigurationWithSource>, cdn?: string) {\n  const restConfig = { ...configuration }\n\n  const functionProps: string[] = []\n\n  for (const [key, value] of Object.entries(configuration) as [keyof typeof configuration, unknown][]) {\n    if (typeof value === 'function') {\n      functionProps.push(`\"${key}\": ${value.toString()}`)\n      delete restConfig[key]\n    } else if (Array.isArray(value) && value.some((item) => typeof item === 'function')) {\n      // Handle arrays that contain functions (like plugins)\n      functionProps.push(`\"${key}\": ${serializeArrayWithFunctions(value)}`)\n      delete restConfig[key]\n    }\n  }\n\n  // Stringify the rest of the configuration\n  const configString = JSON.stringify(restConfig, null, 2)\n    .split('\\n')\n    .map((line, index) => (index === 0 ? line : '      ' + line))\n    .join('\\n')\n    .replace(/\\s*}$/, '') // Remove the closing brace and any whitespace before it\n\n  const functionPropsString = functionProps.length ? `,\\n        ${functionProps.join(',\\n        ')}\\n      }` : '}'\n\n  return `\n    <!-- Load the Script -->\n    <script src=\"${cdn ?? 'https://cdn.jsdelivr.net/npm/@scalar/api-reference'}\"></script>\n\n    <!-- Initialize the Scalar API Reference -->\n    <script type=\"text/javascript\">\n      Scalar.createApiReference('#app', ${configString}${functionPropsString})\n    </script>`\n}\n\n/**\n * The configuration to pass to the @scalar/api-reference package.\n */\nexport const getConfiguration = (\n  givenConfiguration: Partial<ApiReferenceConfigurationWithSource>,\n): Partial<ApiReferenceConfigurationWithSource> => {\n  // Clone the given configuration\n  const configuration = {\n    ...givenConfiguration,\n  }\n\n  // Execute content if it's a function\n  if (typeof configuration.content === 'function') {\n    configuration.content = configuration.content()\n  }\n\n  // Only remove content if url is provided\n  if (configuration.content && configuration.url) {\n    delete configuration.content\n  }\n\n  // Just return regular JSON string, no HTML escaping needed\n  return configuration\n}\n"],
  "mappings": "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",
  "names": []
}
